webpackJsonp([8,15],{"+RFk":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("lC5x"),a=r.n(n),o=r("J0Oq"),i=r.n(o),l=r("qbod"),s={inject:["reload"],data:function(){return{dialogVisible:!1,form:{itemNumber:null,itemName:null,costAccountNumber:null,workAmount:null,measurementUnit:null,unitPrice:null,totalPrice:null},measurementUnit:[{id:"1",value:"m"},{id:"2",value:"㎡"},{id:"3",value:"m³"},{id:"4",value:"其他"}],rules:{workAmount:[{required:!0,message:"请输入工作量",trigger:"blur"},{type:"number",message:"请输入数字"}],measurementUnit:[{required:!0,message:"请选择单位",trigger:"change"}],unitPrice:[{required:!0,message:"请输入单价",trigger:"blur"},{type:"number",message:"请输入数字"}]}}},methods:{init:function(e){var t=this;return i()(a.a.mark(function r(){return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.dialogVisible=!0,t.form=e;case 2:case"end":return r.stop()}},r,t)}))()},onSubmit:function(e){var t,r=this;this.$refs[e].validate((t=i()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}if(null!==r.form.totalPrice){e.next=7;break}return r.form.totalPrice=r.form.workAmount*r.form.unitPrice,e.next=5,Object(l.e)(r.form).then(function(e){r.$message.success("编辑成功"),r.$parent.reloads(),r.dialogVisible=!1});case 5:e.next=10;break;case 7:return r.form.totalPrice=r.form.workAmount*r.form.unitPrice,e.next=10,Object(l.m)(r.form).then(function(e){r.$message.success("更新成功"),r.$parent.reloads(),r.dialogVisible=!1});case 10:e.next=13;break;case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))},resetForm:function(){this.dialogVisible=!1}},created:function(){}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"editCostTargetInfo"},[r("el-dialog",{attrs:{title:"编辑",visible:e.dialogVisible,width:"700px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{"label-position":"right",rules:e.rules,model:e.form,"label-width":"80px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{width:"320px"},attrs:{label:"项目编号：",prop:"itemNumber"}},[r("el-input",{attrs:{readOnly:""},model:{value:e.form.itemNumber,callback:function(t){e.$set(e.form,"itemNumber",t)},expression:"form.itemNumber"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{width:"320px"},attrs:{label:"项目名称：",prop:"itemName"}},[r("el-input",{attrs:{readOnly:""},model:{value:e.form.itemName,callback:function(t){e.$set(e.form,"itemName",t)},expression:"form.itemName"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{width:"320px"},attrs:{label:"科目编号：",prop:"costAccountNumber"}},[r("el-input",{attrs:{readOnly:""},model:{value:e.form.costAccountNumber,callback:function(t){e.$set(e.form,"costAccountNumber",t)},expression:"form.costAccountNumber"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{width:"320px"},attrs:{label:"科目名称：",prop:"costAccountName"}},[r("el-input",{attrs:{readOnly:""},model:{value:e.form.costAccountName,callback:function(t){e.$set(e.form,"costAccountName",t)},expression:"form.costAccountName"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{width:"320px"},attrs:{label:"工作量：",prop:"workAmount"}},[r("el-input",{model:{value:e.form.workAmount,callback:function(t){e.$set(e.form,"workAmount",e._n(t))},expression:"form.workAmount"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{width:"320px"},attrs:{label:"单位：",prop:"measurementUnit"}},[r("el-select",{staticStyle:{width:"225px"},attrs:{placeholder:"请选择单位"},model:{value:e.form.measurementUnit,callback:function(t){e.$set(e.form,"measurementUnit",t)},expression:"form.measurementUnit"}},e._l(e.measurementUnit,function(e){return r("el-option",{key:e.id,attrs:{label:e.value,value:e.value}})}),1)],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{width:"320px"},attrs:{label:"单价：",prop:"unitPrice"}},[r("el-input",{model:{value:e.form.unitPrice,callback:function(t){e.$set(e.form,"unitPrice",e._n(t))},expression:"form.unitPrice"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{width:"320px"},attrs:{label:"总价：",prop:"totalPrice"}},[r("el-input",{attrs:{readOnly:""},model:{value:e.form.totalPrice,callback:function(t){e.$set(e.form,"totalPrice",t)},expression:"form.totalPrice"}})],1)],1)],1),e._v(" "),r("el-form-item",{staticStyle:{margin:"20px 0 0 170px"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("确认")]),e._v(" "),r("el-button",{on:{click:function(t){return e.resetForm()}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var u=r("C7Lr")(s,c,!1,function(e){r("+k7W")},null,null);t.default=u.exports},"+k7W":function(e,t){},"UEy/":function(e,t){},ekVs:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("lC5x"),a=r.n(n),o=r("J0Oq"),i=r.n(o),l=r("qbod"),s=r("WNVK"),c={inject:["reload"],components:{EditCostTarget:r("+RFk").default},data:function(){return{tableData:[],currentRow:null,editCostTargetVisible:!1,options:[],itemNumber:null}},methods:{setCurrent:function(e){this.$refs.singleTable.setCurrentRow(e)},handleCurrentChange:function(e){this.currentRow=e},load:function(e,t,r){var n=this;setTimeout(i()(a.a.mark(function t(){var o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(l.b)({costAccountNumber:e.costAccountNumber});case 2:o=t.sent,r(o.data);case 4:case"end":return t.stop()}},t,n)})),50)},editCostTarget:function(){var e=this;null!==this.currentRow?!0===this.currentRow.hasChildren?this.$message.error("请选择详细科目"):(this.editCostTargetVisible=!0,this.$nextTick(function(){e.$refs.EditCostTarget.init(e.currentRow)})):this.$message.error("请选择一项成本科目")},selectItem:function(){var e=this;return i()(a.a.mark(function t(){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.n)();case 2:r=t.sent,e.options=r.data,e.getCostTargetMerge();case 5:case"end":return t.stop()}},t,e)}))()},getCostTargetMerge:function(){var e=this;return i()(a.a.mark(function t(){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.itemNumber=e.options[0].itemNumber,t.next=3,Object(l.c)({itemNumber:e.itemNumber});case 3:r=t.sent,e.tableData=r.data;case 5:case"end":return t.stop()}},t,e)}))()},reloads:function(){this.reload()}},created:function(){this.selectItem()}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"menu4_item1"},[r("div",{staticClass:"blank"}),e._v(" "),r("div",{staticClass:"topHead"},[r("div",{staticClass:"buttonList"},[r("el-button",{attrs:{type:"primary"},on:{click:e.editCostTarget}},[e._v("编辑")]),e._v(" "),r("el-select",{attrs:{filterable:"",placeholder:"请选择项目"},on:{change:function(t){return e.getCostTargetMerge(t)}},model:{value:e.itemNumber,callback:function(t){e.itemNumber=t},expression:"itemNumber"}},e._l(e.options,function(e){return r("el-option",{key:e.itemNumber,attrs:{label:e.itemName,value:e.itemNumber}})}),1)],1)]),e._v(" "),r("el-main",[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"max-height":"600px","row-key":"costAccountId","highlight-current-row":"",border:"",lazy:"",load:e.load,"tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"current-change":e.handleCurrentChange}},[r("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),r("el-table-column",{attrs:{prop:"costAccountNumber",label:"成本科目编号",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"costAccountName",label:"成本科目名称",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"itemNumber",label:"项目编号",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"itemName",label:"项目名称",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"workAmount",label:"工作量",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"measurementUnit",label:"单位",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"unitPrice",label:"单价(元)",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{prop:"totalPrice",label:"总价(元)"}})],1)],1),e._v(" "),e.editCostTargetVisible?r("EditCostTarget",{ref:"EditCostTarget"}):e._e()],1)},staticRenderFns:[]};var m=r("C7Lr")(c,u,!1,function(e){r("UEy/")},null,null);t.default=m.exports}});
//# sourceMappingURL=8.b00aa061463761be6b99.js.map